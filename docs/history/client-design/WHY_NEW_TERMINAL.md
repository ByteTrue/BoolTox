# ä¸ºä»€ä¹ˆ CLI å·¥å…·å¿…é¡»åœ¨æ–°ç»ˆç«¯ä¸­å¯åŠ¨ï¼Ÿ

> è§£ç­”ï¼šä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ `node cli.js` æˆ– `python cli.py` å¯åŠ¨ï¼Ÿ

---

## TL;DRï¼ˆç»“è®ºï¼‰

**ç›´æ¥å¯åŠ¨ CLI ç¨‹åºä¸ä¼šæ‰“å¼€æ–°çª—å£ï¼Œç¨‹åºä¼šåœ¨åå°è¿è¡Œï¼Œç”¨æˆ·çœ‹ä¸åˆ°ä»»ä½•è¾“å‡ºã€‚**

- âŒ ç›´æ¥å¯åŠ¨ï¼š`spawn('node', ['cli.js'])` â†’ åå°è¿è¡Œï¼Œæ— è¾“å‡º
- âœ… æ­£ç¡®æ–¹å¼ï¼šåœ¨æ–°ç»ˆç«¯ä¸­å¯åŠ¨ â†’ ç”¨æˆ·å¯è§çš„ç‹¬ç«‹çª—å£

---

## æ ¸å¿ƒæ¦‚å¿µï¼šTTYï¼ˆç»ˆç«¯ï¼‰

### ä»€ä¹ˆæ˜¯ TTYï¼Ÿ

TTYï¼ˆTeleTYpewriterï¼‰æ˜¯ä¸€ä¸ªä¼ªç»ˆç«¯è®¾å¤‡ï¼Œæä¾›ï¼š
- **æ ‡å‡†è¾“å…¥**ï¼ˆstdinï¼‰ï¼šé”®ç›˜è¾“å…¥
- **æ ‡å‡†è¾“å‡º**ï¼ˆstdoutï¼‰ï¼šæ–‡æœ¬è¾“å‡º
- **ANSI è½¬ä¹‰åºåˆ—**ï¼šé¢œè‰²ã€å…‰æ ‡æ§åˆ¶
- **äº¤äº’æ¨¡å¼**ï¼šå®æ—¶é”®ç›˜æ•è·ï¼ˆå¦‚æ–¹å‘é”®ã€Enterï¼‰

### CLI å·¥å…·éœ€è¦ TTY

äº¤äº’å¼ CLI å·¥å…·ï¼ˆå¦‚ `inquirer`ã€`prompt_toolkit`ï¼‰ä¾èµ– TTY ç¯å¢ƒï¼š

```javascript
// inquirer å†…éƒ¨æ£€æŸ¥
if (!process.stdin.isTTY) {
  throw new Error('æ— æ³•åœ¨å½“å‰ç¯å¢ƒæ¸²æŸ“æç¤º');
}
```

```python
# prompt_toolkit å†…éƒ¨æ£€æŸ¥
if not sys.stdin.isatty():
    raise RuntimeError('stdin is not a terminal')
```

**å¦‚æœæ²¡æœ‰ TTY**ï¼š
- ç¨‹åºæ£€æµ‹å¤±è´¥ï¼Œç›´æ¥é€€å‡º
- å³ä½¿ä¸é€€å‡ºï¼Œç”¨æˆ·ä¹Ÿæ— æ³•è¾“å…¥å’Œäº¤äº’

---

## å®éªŒå¯¹æ¯”

### å®éªŒ 1ï¼šç›´æ¥å¯åŠ¨ï¼ˆç”¨æˆ·æœŸæœ›çš„æ–¹å¼ï¼‰

```bash
# åœ¨ Electron ä¸­ç›´æ¥å¯åŠ¨
spawn('node', ['cli.js'], { stdio: 'ignore' })
```

**ç»“æœ**ï¼š
- âŒ æ²¡æœ‰æ–°çª—å£æ‰“å¼€
- âŒ ç¨‹åºåœ¨åå°è¿è¡Œ
- âŒ ç”¨æˆ·çœ‹ä¸åˆ°ä»»ä½•è¾“å‡º
- âŒ äº¤äº’å¼åŠŸèƒ½ä¸å¯ç”¨ï¼ˆexit code: 1ï¼‰

**æ—¥å¿—è¾“å‡º**ï¼š
```
[ToolRunner] CLI å·¥å…·å·²åœ¨ç»ˆç«¯å¯åŠ¨ (PID: 12345)
[ToolRunner] CLI å·¥å…·é€€å‡º (code: 1)  â† ç«‹å³é€€å‡ºï¼
```

### å®éªŒ 2ï¼šåœ¨æ–°ç»ˆç«¯ä¸­å¯åŠ¨ï¼ˆå½“å‰æ–¹æ¡ˆï¼‰

```bash
# Windows
start "æ ‡é¢˜" cmd /K node cli.js

# macOS
osascript -e 'tell application "Terminal" to do script "node cli.js"'

# Linux
gnome-terminal -- bash -c "node cli.js"
```

**ç»“æœ**ï¼š
- âœ… æ‰“å¼€æ–°çš„ç»ˆç«¯çª—å£
- âœ… ç”¨æˆ·å¯ä»¥çœ‹åˆ°è¾“å‡ºå’Œäº¤äº’ç•Œé¢
- âœ… äº¤äº’å¼ TUI æ­£å¸¸å·¥ä½œ
- âœ… ç”¨æˆ·å¯ä»¥éšæ—¶åˆ‡æ¢åˆ°ç»ˆç«¯çª—å£

---

## ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªè¯¯è§£ï¼Ÿ

### GUI ç¨‹åº vs CLI ç¨‹åº

| ç±»å‹ | å¯åŠ¨æ–¹å¼ | çª—å£è¡Œä¸º |
|------|---------|---------|
| **GUI ç¨‹åº** | `app.exe` | è‡ªåŠ¨åˆ›å»ºçª—å£ |
| **CLI ç¨‹åº** | `node cli.js` | åœ¨å½“å‰ stdio è¿è¡Œ |

**å…³é”®åŒºåˆ«**ï¼š
- GUI ç¨‹åºï¼ˆ.exeï¼‰ä¼šè°ƒç”¨ç³»ç»Ÿ API åˆ›å»ºçª—å£
- CLI ç¨‹åºä¾èµ–**è°ƒç”¨è€…æä¾›çš„ç»ˆç«¯ç¯å¢ƒ**ï¼ˆstdin/stdout/stderrï¼‰

### æ“ä½œç³»ç»Ÿè¡Œä¸º

åœ¨ Windows/macOS/Linux ä¸Šï¼š
- åŒå‡» `.exe` â†’ æ“ä½œç³»ç»Ÿä¼šåˆ›å»ºæ–°çª—å£ï¼ˆå¦‚æœæ˜¯ GUI ç¨‹åºï¼‰
- è¿è¡Œ `node script.js` â†’ ä½¿ç”¨**å½“å‰è¿›ç¨‹çš„ stdio**
- ä» Electron åå°å¯åŠ¨ â†’ æ²¡æœ‰å¯è§çš„ç»ˆç«¯

**ç±»æ¯”**ï¼š
- GUI ç¨‹åºåƒé¤å…çš„ç‹¬ç«‹åŒ…é—´ï¼ˆè‡ªå¸¦æ¡Œæ¤…ï¼‰
- CLI ç¨‹åºåƒå¤–å–ï¼ˆéœ€è¦ä½ æä¾›æ¡Œå­ï¼‰

---

## æŠ€æœ¯ç»†èŠ‚

### stdio çš„ä¸‰ç§æ¨¡å¼

```javascript
spawn('node', ['cli.js'], {
  stdio: 'inherit',  // ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ stdioï¼ˆElectron çª—å£ä¸å¯è§ï¼‰
  stdio: 'ignore',   // å®Œå…¨å¿½ç•¥è¾“å‡ºï¼ˆç”¨æˆ·ä»€ä¹ˆéƒ½çœ‹ä¸åˆ°ï¼‰
  stdio: 'pipe',     // é€šè¿‡ç®¡é“é€šä¿¡ï¼ˆéœ€è¦æ‰‹åŠ¨è¯»å–è¾“å‡ºï¼‰
});
```

**é—®é¢˜**ï¼š
- Electron ä¸»è¿›ç¨‹æ²¡æœ‰å¯è§çš„ stdio
- å³ä½¿ç”¨ `pipe` è¯»å–è¾“å‡ºï¼Œç”¨æˆ·ä¹Ÿçœ‹ä¸åˆ°ï¼ˆé™¤éç”¨ xterm.js åµŒå…¥ç»ˆç«¯ï¼‰

### ä¸ºä»€ä¹ˆä¸åµŒå…¥ç»ˆç«¯ï¼Ÿ

å¯ä»¥ä½¿ç”¨ `xterm.js` åœ¨ Electron ä¸­åµŒå…¥ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œä½†è¿™è¿èƒŒäº† BoolTox çš„è®¾è®¡ç†å¿µï¼š

**BoolTox çš„æ ¸å¿ƒç†å¿µ**ï¼š
- å·¥å…·å®Œå…¨ç‹¬ç«‹ï¼Œå¯æ‰‹åŠ¨è¿è¡Œï¼ˆ`python tool.py` æˆ– `node tool.js`ï¼‰
- ä¸ä¾èµ– BoolTox SDK
- åœ¨ç³»ç»Ÿé»˜è®¤ç¯å¢ƒä¸­è¿è¡Œï¼ˆæµè§ˆå™¨æˆ–åŸç”Ÿç»ˆç«¯ï¼‰

**å¦‚æœåµŒå…¥ç»ˆç«¯**ï¼š
- å·¥å…·è¢«é”å®šåœ¨ BoolTox çª—å£ä¸­
- å¤±å»äº†ç‹¬ç«‹æ€§å’Œä¾¿æºæ€§
- ç”¨æˆ·æ— æ³•åœ¨ç³»ç»Ÿç»ˆç«¯ä¸­æ‰‹åŠ¨æµ‹è¯•

---

## å½“å‰æ–¹æ¡ˆçš„ä¼˜åŠ¿

### 1. å·¥å…·ç‹¬ç«‹æ€§

å·¥å…·å¯ä»¥**å®Œå…¨è„±ç¦» BoolTox è¿è¡Œ**ï¼š

```bash
# æ‰‹åŠ¨æµ‹è¯• Python å·¥å…·
cd tool-directory
python cli.py

# æ‰‹åŠ¨æµ‹è¯• Node.js å·¥å…·
cd tool-directory
node cli.js
```

### 2. ç”¨æˆ·ä½“éªŒ

- ç‹¬ç«‹çš„ç»ˆç«¯çª—å£ï¼Œå¯ä»¥è‡ªç”±è°ƒæ•´å¤§å°
- æ”¯æŒç³»ç»Ÿç»ˆç«¯çš„æ‰€æœ‰åŠŸèƒ½ï¼ˆå¤åˆ¶ç²˜è´´ã€å†å²è®°å½•ï¼‰
- å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªå·¥å…·

### 3. è·¨å¹³å°ä¸€è‡´æ€§

```typescript
// ç»Ÿä¸€çš„å¯åŠ¨é€»è¾‘
switch (platform) {
  case 'darwin': return launchMacOS(options);
  case 'win32':  return launchWindows(options);
  case 'linux':  return launchLinux(options);
}
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆ Git Bash å¯ä»¥ç›´æ¥æ‰“å¼€çª—å£ï¼Ÿ

A: Git Bash æ˜¯ä¸€ä¸ª **GUI åŒ…è£…å™¨**ï¼Œå†…éƒ¨è°ƒç”¨äº† minttyï¼ˆç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼‰ã€‚å®ƒä¸æ˜¯çº¯ CLI ç¨‹åºã€‚

### Q2: VSCode çš„ç»ˆç«¯æ€ä¹ˆåšçš„ï¼Ÿ

A: VSCode ä½¿ç”¨ `xterm.js` åµŒå…¥äº†å®Œæ•´çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œä½†è¿™éœ€è¦ï¼š
- ç»´æŠ¤ä¸€ä¸ªç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼ˆå¤æ‚åº¦é«˜ï¼‰
- å·¥å…·è¢«é”å®šåœ¨ VSCode ä¸­
- ä¸ç¬¦åˆ BoolTox çš„ç‹¬ç«‹å·¥å…·ç†å¿µ

### Q3: èƒ½ä¸èƒ½æ£€æµ‹åˆ° TTY ç¼ºå¤±åè‡ªåŠ¨æ‰“å¼€ç»ˆç«¯ï¼Ÿ

A: ä¸è¡Œï¼Œå› ä¸ºï¼š
- ç¨‹åºå¯åŠ¨æ—¶å°±éœ€è¦ TTYï¼ˆæ— æ³•å»¶è¿Ÿï¼‰
- æ£€æµ‹åˆ°å¤±è´¥åç¨‹åºå·²ç»é€€å‡º

### Q4: å¯ä»¥ç”¨ `console.log` æ›¿ä»£äº¤äº’å¼è¾“å…¥å—ï¼Ÿ

A: ä¸è¡Œï¼Œäº¤äº’å¼ TUI éœ€è¦ï¼š
- å®æ—¶é”®ç›˜è¾“å…¥ï¼ˆæ–¹å‘é”®ã€Enterï¼‰
- ANSI è½¬ä¹‰åºåˆ—ï¼ˆå…‰æ ‡ç§»åŠ¨ã€é¢œè‰²ï¼‰
- å±å¹•åˆ·æ–°ï¼ˆä¸æ˜¯ç®€å•çš„æ–‡æœ¬è¾“å‡ºï¼‰

---

## æ€»ç»“

| æ–¹æ¡ˆ | ç”¨æˆ·å¯è§ | äº¤äº’æ”¯æŒ | å·¥å…·ç‹¬ç«‹æ€§ |
|------|---------|---------|-----------|
| ç›´æ¥å¯åŠ¨ | âŒ | âŒ | âœ… |
| åµŒå…¥ç»ˆç«¯ï¼ˆxterm.jsï¼‰| âœ… | âœ… | âŒ |
| **æ–°ç»ˆç«¯çª—å£ï¼ˆå½“å‰ï¼‰** | âœ… | âœ… | âœ… |

**Linus è¯„ä»·**ï¼š
> ğŸŸ¢ **å¥½å“å‘³çš„è®¾è®¡**
>
> è¿™æ˜¯æ•°æ®ç»“æ„ï¼ˆTTYï¼‰å†³å®šä»£ç è´¨é‡çš„å…¸å‹æ¡ˆä¾‹ï¼š
> - CLI å·¥å…·çš„æœ¬è´¨æ˜¯æ“ä½œ stdio æµ
> - ä¸æä¾› TTY å°±åƒç»™å‡½æ•°ä¼  NULL æŒ‡é’ˆ
> - åˆ›å»ºæ–°ç»ˆç«¯æ˜¯å”¯ä¸€æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆ
>
> **ä¸è¦è¯•å›¾ç»•è¿‡ç³»ç»Ÿçš„åŸºæœ¬è®¾è®¡**ã€‚TTY æ˜¯ Unix å“²å­¦çš„æ ¸å¿ƒï¼Œå·²ç»å­˜åœ¨ 50 å¹´ã€‚ä½ çš„ä»£ç åº”è¯¥é¡ºåº”å®ƒï¼Œè€Œä¸æ˜¯å¯¹æŠ—å®ƒã€‚

---

## å‚è€ƒèµ„æ–™

- [TTY è¯¦è§£](https://www.linusakesson.net/programming/tty/)
- [Node.js TTY æ–‡æ¡£](https://nodejs.org/api/tty.html)
- [Python TTY æ£€æŸ¥](https://docs.python.org/3/library/sys.html#sys.stdin)
